USE MASTER
GO

CREATE DATABASE CLINICA
GO

USE CLINICA
GO

CREATE TABLE NACIONALIDADES (
	CODIGO INT PRIMARY KEY IDENTITY(1,1),
	DESCRIPCION VARCHAR(20) NOT NULL
)

CREATE TABLE PROVINCIAS (
	CODIGO INT PRIMARY KEY IDENTITY(1,1),
	DESCRIPCION VARCHAR(20) NOT NULL
)

CREATE TABLE PACIENTES(
	CODIGO INT PRIMARY KEY IDENTITY(1,1),
	DNI INT UNIQUE NOT NULL,
	NOMBRE VARCHAR (20) NOT NULL,
	APELLIDO VARCHAR(30) NOT NULL,
	SEXO VARCHAR(1) CHECK (SEXO IN('F','M')) NOT NULL,
	COD_NACIONALIDAD INT FOREIGN KEY REFERENCES NACIONALIDADES(CODIGO) NOT NULL,
	FECHA_NAC DATE NOT NULL,
	DIRECCION VARCHAR(40) NOT NULL,
	LOCALIDAD VARCHAR(20) NOT NULL,
	PROVINCIA INT FOREIGN KEY REFERENCES PROVINCIAS(CODIGO) NOT NULL,
	EMAIL VARCHAR(40),
	TELEFONO VARCHAR(15) NOT NULL,
	ESTADO BIT NOT NULL
)

CREATE TABLE ESPECIALIDADES (
	CODIGO INT PRIMARY KEY IDENTITY(1,1),
	DESCRIPCION VARCHAR(20) NOT NULL
)

CREATE TABLE TIPOS_USUARIO (
	CODIGO INT PRIMARY KEY IDENTITY(1,1),
	DESCRIPCION VARCHAR(20) NOT NULL
)

CREATE TABLE EMPLEADOS(
	DNI INT PRIMARY KEY,
	NOMBRE VARCHAR (20) NOT NULL,
	APELLIDO VARCHAR(30) NOT NULL,
	SEXO VARCHAR(1) CHECK (SEXO IN('F','M')) NOT NULL,
	COD_NACIONALIDAD INT FOREIGN KEY REFERENCES NACIONALIDADES(CODIGO) NOT NULL,
	FECHA_NAC DATE NOT NULL,
	DIRECCION VARCHAR(40) NOT NULL,
	LOCALIDAD VARCHAR(20) NOT NULL,
	PROVINCIA INT FOREIGN KEY REFERENCES PROVINCIAS(CODIGO) NOT NULL,
	EMAIL VARCHAR(40) NOT NULL,
	TELEFONO VARCHAR(15) NOT NULL,
	COD_TIPOSUSUARIO INT FOREIGN KEY REFERENCES TIPOS_USUARIO(CODIGO) NOT NULL,
	ESTADO BIT
)

CREATE TABLE DIASEMANA(
	CODIGO INT PRIMARY KEY,
	DESCRIPCION VARCHAR(10) UNIQUE NOT NULL
)

CREATE TABLE MEDICO_POR_ESPECIALIDAD(
	DNIMEDICO INT FOREIGN KEY REFERENCES EMPLEADOS(DNI),
	COD_ESPECIALIDAD INT FOREIGN KEY REFERENCES ESPECIALIDADES(CODIGO) NOT NULL,
	DIASEMANA INT FOREIGN KEY REFERENCES DIASEMANA(CODIGO) NOT NULL,
	HORAINICIO TIME NOT NULL, 
	HORAFIN TIME NOT NULL,
	ESTADO BIT NOT NULL,

	PRIMARY KEY (DNIMEDICO, DIASEMANA, COD_ESPECIALIDAD)
)

CREATE TABLE ESTADOS_TURNOS (
	CODIGO INT PRIMARY KEY IDENTITY(1,1),
	DESCRIPCION VARCHAR(20) NOT NULL
)

CREATE TABLE TURNOS(
	DNIMEDICO INT FOREIGN KEY REFERENCES EMPLEADOS(DNI),
	DIA DATE NOT NULL,
	HORARIO TIME NOT NULL, 
	COD_PACIENTE INT FOREIGN KEY REFERENCES PACIENTES(CODIGO),
	COD_ESPECIALIDAD INT FOREIGN KEY REFERENCES ESPECIALIDADES(CODIGO) NOT NULL,
	COD_ESTADO_TURNO INT FOREIGN KEY REFERENCES ESTADOS_TURNOS(CODIGO) NOT NULL,
	ESTADO BIT NOT NULL,

	PRIMARY KEY (DNIMEDICO, DIA, HORARIO)
)

CREATE TABLE USUARIOS (
	CODIGO INT PRIMARY KEY IDENTITY(1,1),
	DNI INT FOREIGN KEY REFERENCES EMPLEADOS(DNI) UNIQUE NOT NULL,
	CONTRASENIA VARCHAR(20) NOT NULL,
	ESTADO BIT NOT NULL
)


-- INSERCIÓN DE DATOS EN LA BASE DE DATOS

-- TABLA DIASSEMANA
INSERT INTO DIASEMANA(CODIGO, DESCRIPCION) VALUES(1, 'LUNES')
INSERT INTO DIASEMANA(CODIGO, DESCRIPCION) VALUES(2, 'MARTES')
INSERT INTO DIASEMANA(CODIGO, DESCRIPCION) VALUES(3, 'MIERCOLES')
INSERT INTO DIASEMANA(CODIGO, DESCRIPCION) VALUES(4, 'JUEVES')
INSERT INTO DIASEMANA(CODIGO, DESCRIPCION) VALUES(5, 'VIERNES')
INSERT INTO DIASEMANA(CODIGO, DESCRIPCION) VALUES(6, 'SABADO')

-- TABLA ESPECIALIDADES
INSERT INTO ESPECIALIDADES(DESCRIPCION) VALUES('PEDIATRIA')
INSERT INTO ESPECIALIDADES(DESCRIPCION) VALUES('OTORRINOLARINGOLOGIA')
INSERT INTO ESPECIALIDADES(DESCRIPCION) VALUES('ALERGIA')
INSERT INTO ESPECIALIDADES(DESCRIPCION) VALUES('CLINICA')
INSERT INTO ESPECIALIDADES(DESCRIPCION) VALUES('NEUMONOLOGIA')
INSERT INTO ESPECIALIDADES(DESCRIPCION) VALUES('DERMATOLOGIA')
INSERT INTO ESPECIALIDADES(DESCRIPCION) VALUES('NUTRICION')

--TABLA ESTADOS_TURNOS
INSERT INTO ESTADOS_TURNOS(DESCRIPCION) VALUES('LIBRE')
INSERT INTO ESTADOS_TURNOS(DESCRIPCION) VALUES('OCUPADO')
INSERT INTO ESTADOS_TURNOS(DESCRIPCION) VALUES('AUSENTE')
INSERT INTO ESTADOS_TURNOS(DESCRIPCION) VALUES('PRESENTE')

-- TABLA NACIONALIDADES
INSERT INTO NACIONALIDADES(DESCRIPCION) VALUES('ARGENTINA')
INSERT INTO NACIONALIDADES(DESCRIPCION) VALUES('CHILE')
INSERT INTO NACIONALIDADES(DESCRIPCION) VALUES('URUGUAY')
INSERT INTO NACIONALIDADES(DESCRIPCION) VALUES('BOLIVIA')
INSERT INTO NACIONALIDADES(DESCRIPCION) VALUES('PARAGUAY')

-- TABLA PROVINCIAS
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('BUENOS AIRES')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('CABA')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('ENTRE RIOS')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('SANTA FE')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('LA PAMPA')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('MENDOZA')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('RIO NEGRO')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('CHUBUT')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('SANTA CRUZ')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('NEUQUEN')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('LA RIOJA')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('CATAMARCA')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('FORMOSA')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('JUJUY')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('CHACO')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('SALTA')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('MISIONES')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('TIERRA DEL FUEGO')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('CORDOBA')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('CORRIENTES')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('SAN JUAN')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('SAN LUIS')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('SANTIAGO DEL ESTERO')
INSERT INTO PROVINCIAS(DESCRIPCION) VALUES('TUCUMAN')

--TABLA TIPOS USUARIO
INSERT INTO TIPOS_USUARIO(DESCRIPCION) VALUES('ADMINISTRADOR')
INSERT INTO TIPOS_USUARIO(DESCRIPCION) VALUES('MEDICO')

--TABLA EMPLEADOS
set dateformat dmy;
INSERT INTO EMPLEADOS(DNI, NOMBRE, APELLIDO, SEXO, COD_NACIONALIDAD, FECHA_NAC, DIRECCION, LOCALIDAD, PROVINCIA, EMAIL, TELEFONO, COD_TIPOSUSUARIO, ESTADO)
VALUES (11111111, 'JUAN', 'PEREZ', 'M', 1, '25/03/1977', 'LOS PATOS 5855', 'CABA', 1,'juanperez@clinica.com', '1111111111', 2, 1) 
INSERT INTO EMPLEADOS(DNI, NOMBRE, APELLIDO, SEXO, COD_NACIONALIDAD, FECHA_NAC, DIRECCION, LOCALIDAD, PROVINCIA, EMAIL, TELEFONO, COD_TIPOSUSUARIO, ESTADO)
VALUES (22222222, 'MARIO', 'CARRANZA', 'M', 1, '05/07/1971', 'ACASSUSO 8788', 'BUENOS AIRES', 2,'mariocarranza@clinica.com', '2222222222', 2, 1) 
INSERT INTO EMPLEADOS(DNI, NOMBRE, APELLIDO, SEXO, COD_NACIONALIDAD, FECHA_NAC, DIRECCION, LOCALIDAD, PROVINCIA, EMAIL, TELEFONO, COD_TIPOSUSUARIO, ESTADO)
VALUES (33333333, 'EZEQUIEL', 'MORENO', 'M', 2, '15/11/1963', 'AV MAIPU 5255', 'OLIVOS', 2,'ezequielmoreno@clinica.com', '3333333333', 2, 1) 
INSERT INTO EMPLEADOS(DNI, NOMBRE, APELLIDO, SEXO, COD_NACIONALIDAD, FECHA_NAC, DIRECCION, LOCALIDAD, PROVINCIA, EMAIL, TELEFONO, COD_TIPOSUSUARIO, ESTADO)
VALUES (44444444, 'MARIA', 'ROMERO', 'F', 1, '25/08/1966', 'AV. RIVADAVIA 15525', 'RAMOS MEJIA', 2,'mariaromero@clinica.com', '4444444444', 2, 1) 
INSERT INTO EMPLEADOS(DNI, NOMBRE, APELLIDO, SEXO, COD_NACIONALIDAD, FECHA_NAC, DIRECCION, LOCALIDAD, PROVINCIA, EMAIL, TELEFONO, COD_TIPOSUSUARIO, ESTADO)
VALUES (55555555, 'JUANA', 'MARTINEZ', 'F', 4, '16/07/1987', 'AV. CALLAO 560', 'CABA', 1,'juanamartinez@clinica.com', '5555555555', 2, 1) 
INSERT INTO EMPLEADOS(DNI, NOMBRE, APELLIDO, SEXO, COD_NACIONALIDAD, FECHA_NAC, DIRECCION, LOCALIDAD, PROVINCIA, EMAIL, TELEFONO, COD_TIPOSUSUARIO, ESTADO)
VALUES (66666666, 'MARIANA', 'TRIDENTE', 'F', 1, '23/11/1978', 'AV. INDEPENDENCIA 845', 'CABA', 1,'marianatridente@clinica.com', '6666666666', 2, 1) 
INSERT INTO EMPLEADOS(DNI, NOMBRE, APELLIDO, SEXO, COD_NACIONALIDAD, FECHA_NAC, DIRECCION, LOCALIDAD, PROVINCIA, EMAIL, TELEFONO, COD_TIPOSUSUARIO, ESTADO)
VALUES (77777777, 'RAMIRO', 'RAMIREZ', 'M', 3, '15/04/1980', 'AV. MITRE 5478', 'MUNRO', 2,'ramiroramirez@clinica.com', '7777777777', 1, 1) 
INSERT INTO EMPLEADOS(DNI, NOMBRE, APELLIDO, SEXO, COD_NACIONALIDAD, FECHA_NAC, DIRECCION, LOCALIDAD, PROVINCIA, EMAIL, TELEFONO, COD_TIPOSUSUARIO, ESTADO)
VALUES (88888888, 'CAROLINA', 'CASTRO', 'F', 1, '11/09/1985', 'SAN LORENZO 5855', 'OLIVOS', 2,'carolinacastro@clinica.com', '8888888888', 1, 1) 

-- TABLA MEDICOS POR ESPECIALIDAD
set dateformat hhmm;
INSERT INTO MEDICO_POR_ESPECIALIDAD(DNIMEDICO, COD_ESPECIALIDAD, DIASEMANA, HORAINICIO, HORAFIN, ESTADO) 
VALUES(11111111, 5, 3,'14:00','19:00',1)
INSERT INTO MEDICO_POR_ESPECIALIDAD(DNIMEDICO, COD_ESPECIALIDAD, DIASEMANA, HORAINICIO, HORAFIN, ESTADO) 
VALUES(22222222, 3, 3,'14:00','19:00',1)
INSERT INTO MEDICO_POR_ESPECIALIDAD(DNIMEDICO, COD_ESPECIALIDAD, DIASEMANA, HORAINICIO, HORAFIN, ESTADO) 
VALUES(33333333, 1, 1,'09:00','13:00',1)
INSERT INTO MEDICO_POR_ESPECIALIDAD(DNIMEDICO, COD_ESPECIALIDAD, DIASEMANA, HORAINICIO, HORAFIN, ESTADO) 
VALUES(44444444, 6, 3,'10:00','15:00',1)
INSERT INTO MEDICO_POR_ESPECIALIDAD(DNIMEDICO, COD_ESPECIALIDAD, DIASEMANA, HORAINICIO, HORAFIN, ESTADO) 
VALUES(55555555, 2, 5,'14:00','19:00',1)
INSERT INTO MEDICO_POR_ESPECIALIDAD(DNIMEDICO, COD_ESPECIALIDAD, DIASEMANA, HORAINICIO, HORAFIN, ESTADO) 
VALUES(66666666, 4, 2,'10:00','14:00',1)

-- TABLA PACIENTES
set dateformat dmy;
INSERT INTO PACIENTES (DNI, NOMBRE, APELLIDO, SEXO, COD_NACIONALIDAD, FECHA_NAC, DIRECCION, LOCALIDAD, PROVINCIA, EMAIL, TELEFONO, ESTADO)
VALUES (25668455, 'JUAN', 'ORTIZ', 'M', 4, '24/02/1947', 'LOS PATOS 44', 'CABA', 1,'juanortiz@gmail.com', '1158854456', 1) 
INSERT INTO PACIENTES (DNI, NOMBRE, APELLIDO, SEXO, COD_NACIONALIDAD, FECHA_NAC, DIRECCION, LOCALIDAD, PROVINCIA, EMAIL, TELEFONO, ESTADO)
VALUES (35885224, 'NATALIA', 'LOPEZ', 'F', 4, '14/08/1977', 'FLORIDA 3222', 'VICENTE LOPEZ', 2,'natalialopez@gmail.com', '1254478544', 1) 
INSERT INTO PACIENTES (DNI, NOMBRE, APELLIDO, SEXO, COD_NACIONALIDAD, FECHA_NAC, DIRECCION, LOCALIDAD, PROVINCIA, EMAIL, TELEFONO, ESTADO)
VALUES (53558445, 'ANALIA', 'CASALTA', 'F', 1, '24/02/2013', 'RIVERENOS 744', 'CABA', 1,'analiacasalta@gmail.com', '1154485566', 1) 

-- TABLA USUARIOS
INSERT INTO USUARIOS (DNI, CONTRASENIA, ESTADO) VALUES (11111111,'1111',1)
INSERT INTO USUARIOS (DNI, CONTRASENIA, ESTADO) VALUES (22222222,'2222',1)
INSERT INTO USUARIOS (DNI, CONTRASENIA, ESTADO) VALUES (33333333,'3333',1)
INSERT INTO USUARIOS (DNI, CONTRASENIA, ESTADO) VALUES (44444444,'4444',1)
INSERT INTO USUARIOS (DNI, CONTRASENIA, ESTADO) VALUES (55555555,'5555',1)
INSERT INTO USUARIOS (DNI, CONTRASENIA, ESTADO) VALUES (66666666,'6666',1)
INSERT INTO USUARIOS (DNI, CONTRASENIA, ESTADO) VALUES (77777777,'admin',1)
INSERT INTO USUARIOS (DNI, CONTRASENIA, ESTADO) VALUES (88888888,'admin2',1)

-- TABLA TURNOS
set dateformat dmy;
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (11111111, '14/06/2023', '14:00', 5, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_PACIENTE, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (11111111, '14/06/2023', '14:30', 1, 5, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (11111111, '14/06/2023', '15:00', 5, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (11111111, '14/06/2023', '15:30', 5, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (11111111, '14/06/2023', '16:00', 5, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (11111111, '14/06/2023', '16:30', 5, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (11111111, '14/06/2023', '17:00', 5, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (11111111, '14/06/2023', '17:30', 5, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (11111111, '14/06/2023', '18:00', 5, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (11111111, '14/06/2023', '18:30', 5, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (22222222, '14/06/2023', '14:00', 3, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (22222222, '14/06/2023', '14:30', 3, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_PACIENTE, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (22222222, '14/06/2023', '15:00', 1, 3, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (22222222, '14/06/2023', '15:30', 3, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (22222222, '14/06/2023', '16:00', 3, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (22222222, '14/06/2023', '16:30', 3, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (22222222, '14/06/2023', '17:00', 3, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (22222222, '14/06/2023', '17:30', 3, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (22222222, '14/06/2023', '18:00', 3, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (22222222, '14/06/2023', '18:30', 3, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (33333333, '12/06/2023', '14:00', 1, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (33333333, '12/06/2023', '14:30', 1, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (33333333, '12/06/2023', '15:00', 1, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (33333333, '12/06/2023', '15:30', 1, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_PACIENTE, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (33333333, '12/06/2023', '16:00', 3, 1, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (33333333, '12/06/2023', '16:30', 1, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (33333333, '12/06/2023', '17:00', 1, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (33333333, '12/06/2023', '17:30', 1, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (33333333, '12/06/2023', '18:00', 1, 1, 1)
INSERT INTO TURNOS (DNIMEDICO, DIA, HORARIO, COD_ESPECIALIDAD, COD_ESTADO_TURNO, ESTADO)
VALUES (33333333, '12/06/2023', '18:30', 1, 1, 1)


-- PROCEDIMIENTOS DE ALMACENADO

-- SP PARA LISTAR MEDICOS
CREATE PROCEDURE SP_LISTARMEDICOS
AS
BEGIN
	SELECT E.DNI, E.NOMBRE, E.APELLIDO, E.SEXO, E.COD_NACIONALIDAD AS COD_NACIONALIDAD, N.DESCRIPCION AS NACIONALIDAD, E.FECHA_NAC, E.DIRECCION, E.LOCALIDAD, E.PROVINCIA AS COD_PROV, P.DESCRIPCION, E.EMAIL, E.TELEFONO, E.ESTADO, E.COD_TIPOSUSUARIO, ESP.CODIGO, ESP.DESCRIPCION, DS.DESCRIPCION, ME.HORAINICIO, ME.HORAFIN 
	FROM EMPLEADOS AS E
	INNER JOIN NACIONALIDADES AS N ON N.CODIGO=E.COD_NACIONALIDAD
	INNER JOIN PROVINCIAS AS P ON P.CODIGO=E.PROVINCIA
	INNER JOIN MEDICO_POR_ESPECIALIDAD AS ME ON ME.DNIMEDICO = E.DNI
	INNER JOIN ESPECIALIDADES AS ESP ON ESP.CODIGO=ME.COD_ESPECIALIDAD
	INNER JOIN DIASEMANA AS DS ON DS.CODIGO=ME.DIASEMANA
END
GO

-- SP PARA LISTAR ADMINISTRADORES
CREATE PROCEDURE SP_LISTARADMINISTRADORES
AS
BEGIN
	SELECT E.DNI, E.NOMBRE, E.APELLIDO, E.SEXO, E.COD_NACIONALIDAD AS COD_NACIONALIDAD, N.DESCRIPCION AS NACIONALIDAD, E.FECHA_NAC, E.DIRECCION, E.LOCALIDAD, E.PROVINCIA AS COD_PROV, P.DESCRIPCION, E.EMAIL, E.TELEFONO, E.ESTADO, E.COD_TIPOSUSUARIO
	FROM EMPLEADOS AS E
	INNER JOIN NACIONALIDADES AS N ON N.CODIGO=E.COD_NACIONALIDAD
	INNER JOIN PROVINCIAS AS P ON P.CODIGO=E.PROVINCIA
	WHERE E.COD_TIPOSUSUARIO=1
END
GO

-- SP PARA LISTAR PACIENTES
CREATE PROCEDURE SP_LISTARPACIENTES
AS
BEGIN
	SELECT P.CODIGO, P.DNI, P.NOMBRE, P.APELLIDO, P.SEXO, P.COD_NACIONALIDAD AS COD_NACIONALIDAD, N.DESCRIPCION AS NACIONALIDAD, P.FECHA_NAC, P.DIRECCION, P.LOCALIDAD, P.PROVINCIA AS COD_PROV, PROV.DESCRIPCION, P.EMAIL, P.TELEFONO, P.ESTADO
	FROM PACIENTES AS P
	INNER JOIN NACIONALIDADES AS N ON N.CODIGO=P.COD_NACIONALIDAD
	INNER JOIN PROVINCIAS AS PROV ON PROV.CODIGO=P.PROVINCIA
END
GO

-- SP PARA OBTENER TURNOS POR MEDICO
CREATE PROCEDURE SP_LISTAR_TURNOS_POR_DNIMEDICO(@DNIMEDICO INT)
AS
BEGIN
	SELECT T.DNIMEDICO, T.DIA, T.HORARIO, T.COD_PACIENTE, T.COD_ESPECIALIDAD, ESP.DESCRIPCION, T.COD_ESTADO_TURNO, ET.DESCRIPCION, T.ESTADO
	FROM TURNOS AS T
	INNER JOIN EMPLEADOS AS E ON E.DNI=T.DNIMEDICO
	INNER JOIN MEDICO_POR_ESPECIALIDAD AS ME ON ME.DNIMEDICO = E.DNI
	INNER JOIN ESPECIALIDADES AS ESP ON ESP.CODIGO=ME.COD_ESPECIALIDAD
	INNER JOIN ESTADOS_TURNOS AS ET ON ET.CODIGO=T.COD_ESTADO_TURNO
	WHERE T.DNIMEDICO=@DNIMEDICO
END
GO

--SP_LISTAR_TURNOS_POR_DNIMEDICO 11111111


-- SP PARA OBTENER TURNOS SEGÚN DNI PACIENTE
CREATE PROCEDURE SP_LISTAR_TURNOS_DNIPACIENTE(@DNIPACIENTE INT)
AS
BEGIN
	SELECT T.DNIMEDICO, T.DIA, T.HORARIO, T.COD_PACIENTE, T.COD_ESPECIALIDAD, ESP.DESCRIPCION, T.COD_ESTADO_TURNO, ET.DESCRIPCION, T.ESTADO
	FROM TURNOS AS T
	INNER JOIN PACIENTES AS P ON P.CODIGO=T.COD_PACIENTE
	INNER JOIN EMPLEADOS AS E ON E.DNI=T.DNIMEDICO
	INNER JOIN MEDICO_POR_ESPECIALIDAD AS ME ON ME.DNIMEDICO = E.DNI
	INNER JOIN ESPECIALIDADES AS ESP ON ESP.CODIGO=ME.COD_ESPECIALIDAD
	INNER JOIN ESTADOS_TURNOS AS ET ON ET.CODIGO=T.COD_ESTADO_TURNO
	WHERE P.DNI=@DNIPACIENTE
END

--SP_LISTAR_TURNOS_DNIPACIENTE 25668455